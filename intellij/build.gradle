apply from: 'prepareIntellij.gradle'

ext.xtextVersion = '2.8.0-SNAPSHOT'

configure(subprojects.findAll{p->p.name !='intellij-dependencies'}) {
	apply plugin: 'java'
	
	repositories {
		mavenCentral()
		maven {
        url "https://oss.sonatype.org/content/repositories/snapshots/"
    }
	}
	
	configurations {
		provided
	}
	
	sourceSets.main.compileClasspath += configurations.provided
	
	dependencies {
		if (name != 'intellij-dependencies') {
			provided project(':intellij-dependencies')
		}
		provided "org.eclipse.xtext:org.eclipse.xtext.xtext:${xtextVersion}"
		provided "org.eclipse.xtext:org.eclipse.xtext.xbase:${xtextVersion}"
		provided "org.eclipse.xtend:org.eclipse.xtend.lib:${xtextVersion}"
	}
	
	sourceSets {
		main {
			java.srcDirs = ['src', 'xtend-gen', 'src-gen']
			resources.srcDirs = ['src', 'src-gen']
		}
	}
	
	jar {
		metaInf {
			from('META-INF')
		}
	}
	
	sourceCompatibility = 1.5
}